<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KL Telugu Fellowship - Sports Day 2025 Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f8f6fb;
      color: #333;
    }
    header {
      background: linear-gradient(90deg, #6a1b9a, #d4af37);
      color: white;
      padding: 20px;
      text-align: center;
    }
    header h1 {
      margin: 0;
      font-size: 26px;
    }
    .container {
      padding: 20px;
      max-width: 1100px;
      margin: auto;
    }
    h2 {
      color: #6a1b9a;
      border-bottom: 2px solid #d4af37;
      padding-bottom: 5px;
    }
    .card {
      background: #fff;
      padding: 20px;
      margin: 20px 0;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .info-section {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      margin: 30px 0;
    }
    .info-card {
      flex: 1;
      min-width: 280px;
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th {
      background: #d4af37;
      color: white;
      padding: 10px;
      text-align: left;
    }
    td {
      padding: 10px;
      border-bottom: 1px solid #ddd;
    }
    tr:nth-child(even) {
      background: #f2e9f9;
    }
    .accordion {
      cursor: pointer;
      padding: 10px;
      border: none;
      outline: none;
      width: 100%;
      text-align: left;
      background: #eee;
      border-radius: 8px;
      margin-top: 5px;
    }
    .accordion.active, .accordion:hover {
      background: #d4af37;
      color: white;
    }
    .panel {
      display: none;
      padding: 10px;
      background: #fafafa;
      border-left: 2px solid #d4af37;
      margin-bottom: 10px;
    }
    .tshirt-summary td, .tshirt-summary th {
      text-align: center;
    }
    img.logo {
      max-width: 120px;
      margin-bottom: 15px;
    }
    @media(max-width:768px) {
      .info-section {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>KL Telugu Fellowship<br>Sports Day 2025 Dashboard</h1>
  </header>

  <div class="container">

    <!-- Sports Participation by Game -->
    <div class="card">
      <h2>Sports Participation by Game</h2>
      <div id="sportsTable"></div>
    </div>

    <!-- T-Shirt Count -->
    <div class="card">
      <h2>T-Shirt Size Summary</h2>
      <table class="tshirt-summary" id="tshirtSummary">
        <thead>
          <tr><th>Size</th><th>Count</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <!-- Pastoral & Church Info -->
    <section class="info-section">
      <div class="info-card" style="text-align: center;">
        <img src="kltf-logo.png" alt="Church Logo" class="logo">
        <h2>Pastoral Team</h2>
        <p style="text-align: left;"><b>Sr. Pastor:</b> Rev. James Ravinderan</p>
        <p style="text-align: left;"><b>Asst. Pastor:</b> Jerry John</p>
        <p style="text-align: left;"><b>TF Co-Cordinator:</b> Aunty Prema</p>
      </div>

      <div class="info-card">
        <h2>Church Information</h2>
        <p><b>Address:</b><br>
          197, Jln Sultan Abdul Samad,<br>
          Brickfields, 50470 Kuala Lumpur</p>
        <p><b>Phone:</b> +6016-985 6777</p>
        <p><b>Email:</b> kltelugufellowship@gmail.com</p>
        <p><b>Sunday Service:</b> 4:00 PM & 6:00 PM</p>
      </div>
    </section>

  </div>

  <script>
    // Example participant data (replace with Google Sheets fetch)
const SHEET_URL = "https://script.google.com/macros/s/AKfycbwL20prus-KYONoK7IV50CHc2pfy-tUZQ6ptmZm4Sp2NQmwV4xaJx8N2JDr3EAyj1IF/exec";

    async function loadSportsData() {
      try {
        const res = await fetch(SHEET_URL);
        const data = await res.json();

        const sportsMap = {};
        let totalParticipants = 0;

        data.forEach(row => {
          if (row["Sports"]) {
            const sports = row["Sports"].split(",");
            sports.forEach(sport => {
              sport = sport.trim();
              if (!sportsMap[sport]) sportsMap[sport] = [];
              sportsMap[sport].push(row["Name"]);
              totalParticipants++;
            });
          }
        });

        const tbody = document.querySelector("#sportsTable tbody");
        tbody.innerHTML = "";
    const participants = [
      { Name: "Jyothi Sareddy", Sports: "Badminton - Singles (women),Mixed doubles", Role: "player", "T-Shirt": "L" },
      { Name: "Bharath Reddy S", Sports: "Badminton - Doubles (men),Mixed doubles,Cricket", Role: "player", "T-Shirt": "L" },
      { Name: "Anita Paul", Sports: "Cricket", Role: "player", "T-Shirt": "M" },
      { Name: "Ravi Kumar", Sports: "Badminton - Doubles (men)", Role: "player", "T-Shirt": "XL" },
    ];

    // Build sports participation summary
    function buildSportsTable() {
      const sportsMap = {};
      const tshirtCount = {};

      participants.forEach(p => {
        const sports = p.Sports.split(",");
        sports.forEach(s => {
          s = s.trim();
          if (!sportsMap[s]) sportsMap[s] = [];
          sportsMap[s].push(p);
        });

        // T-shirt size count
        const size = p["T-Shirt"];
        if (size) {
          tshirtCount[size] = (tshirtCount[size] || 0) + 1;
        }
      });

      const totalPlayers = participants.length;
      let html = "<table><thead><tr><th>Sport</th><th>Count</th><th>%</th></tr></thead><tbody>";

      Object.entries(sportsMap)
        .sort((a,b) => b[1].length - a[1].length)
        .forEach(([sport, list]) => {
          const percent = ((list.length / totalPlayers) * 100).toFixed(1);
          html += `<tr><td colspan="3">
            <button class="accordion">${sport} — ${list.length} players (${percent}%)</button>
            <div class="panel">`;
          list.forEach(p => {
            html += `<p>• ${p.Name} (T-shirt: ${p["T-Shirt"] || "-"})</p>`;
          });
          html += `</div></td></tr>`;
        });

      html += "</tbody></table>";
      document.getElementById("sportsTable").innerHTML = html;

      // Accordion toggle
      document.querySelectorAll(".accordion").forEach(btn => {
        btn.addEventListener("click", function() {
          this.classList.toggle("active");
          const panel = this.nextElementSibling;
          panel.style.display = panel.style.display === "block" ? "none" : "block";
        });
      });

      // Build T-shirt summary
      const tbody = document.querySelector("#tshirtSummary tbody");
      tbody.innerHTML = "";
      Object.entries(tshirtCount).forEach(([size,count]) => {
        tbody.innerHTML += `<tr><td>${size}</td><td>${count}</td></tr>`;
      });
    }

    buildSportsTable();
  </script>
</body>
</html>
